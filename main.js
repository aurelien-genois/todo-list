(()=>{"use strict";const e=(e,t,s,r)=>{const a={getTitle:()=>e,setTitle:t=>e=t,getDueDate:()=>t,setDueDate:e=>t=e,getDesc:()=>r,setDesc:e=>r=e,taskPriorities:["High","Medium","Low"],getPriority(){return this.taskPriorities[s-1]},setPriority(e){s=e},taskStates:["Done","WIP","Todo","Abandoned"],getState(){return this.taskStates[this.stateDegree-1]},setState(e){this.stateDegree=e}};return Object.assign(Object.create(a),{stateDegree:3})},t=(s=document,{createTextarea:(e,t,s,r)=>{const a=document.createElement("textarea");return a.setAttribute("id",e),a.setAttribute("name",t),a.setAttribute("maxlength",s),a.classList.add(...r),a},createTextInput:(e,t,r,a)=>{const n=s.createElement("input");return n.setAttribute("type","text"),n.setAttribute("id",e),n.setAttribute("name",t),n.setAttribute("maxlength",r),n.classList.add(...a),n.setAttribute("required",!0),n},createSubmit:(e,t)=>{const r=s.createElement("input");return r.setAttribute("type","submit"),r.setAttribute("value",e),r.classList.add(...t),r}});var s;const r=(e=>{const s=e.querySelector("#tasks-list"),r=t=>{const r=t.map((t=>((t,s,r,a,n)=>{const c=e.createElement("li");c.classList.add("tasks");const o=e.createElement("h3");o.textContent=t,o.classList.add("task-title");const i=e.createElement("div");i.classList.add("task-infos");const d=e.createElement("p");d.classList.add("task-duedate"),d.textContent=s;const p=e.createElement("p");p.classList.add("task-state"),p.textContent=a;const l=e.createElement("button");l.classList.add("task-expand-btn"),l.textContent="V",i.append(d,p,l),l.addEventListener("click",(()=>{c.querySelector(".task-expand")?(c.removeChild(m),l.textContent="V"):(c.append(m),l.textContent="A")}));const u=e.createElement("div");u.classList.add("task-main-infos"),u.append(o,i);const m=e.createElement("div");m.classList.add("task-expand");const b=e.createElement("div");b.classList.add("task-details");const k=e.createElement("p");k.classList.add("task-priority"),k.textContent=r;const j=e.createElement("p");j.classList.add("task-desc"),j.textContent=n,b.append(k,j);const T=e.createElement("div");T.classList.add("task-actions");const g=e.createElement("button");g.classList.add("edit-task-btn","round-btn"),g.textContent="/",g.addEventListener("click",(()=>{}));const h=e.createElement("button");return h.classList.add("round-btn","delete-task-btn"),h.textContent="X",h.addEventListener("click",(()=>{})),T.append(g,h),m.append(b,T),c.append(u),c})(t.getTitle(),t.getDueDate(),t.getPriority(),t.getState(),t.getDesc())));for(;s.firstChild;)s.removeChild(s.firstChild);r.map((e=>{s.appendChild(e)}))},a=t=>{let s=n.getAllTasks(),a=[];switch(t.target.dataset.tab){case"today":a=s.filter((e=>1===e.getDueDate()));break;case"this-week":a=s.filter((e=>e.getDueDate()>0));break;case"high-priority":a=s.filter((e=>"High"===e.getPriority()));break;case"all-tasks":a=[...s]}e.querySelector("#edit-project-form")&&e.querySelector("#edit-project-form").replaceWith(u),i.textContent=t.target.textContent,d.textContent="",o.removeAttribute("data-project-id"),p.style.visibility="hidden",l.style.visibility="hidden",r(a)},c=e.querySelector("#projects-tabs"),o=e.querySelector("#project-detail"),i=e.querySelector("#project-title"),d=e.querySelector("#project-desc"),p=e.querySelector("#new-task-btn"),l=e.querySelector("#edit-project-btn");p.style.visibility="hidden",l.style.visibility="hidden";const u=e.querySelector("#project-infos"),m=t=>{r(t.getTasks()),e.querySelector("#edit-project-form")&&e.querySelector("#edit-project-form").replaceWith(u),i.textContent=t.getTitle(),d.textContent=t.getDesc();const s=n.getProjectId(t);o.setAttribute("data-project-id",s),p.style.visibility="visible",l.style.visibility="visible"};return l.addEventListener("click",(()=>{const s=n.getProject(o.dataset.projectId),r=s.getTitle(),a=s.getDesc(),c=e.createElement("form");c.setAttribute("id","edit-project-form");const i=e.createElement("fieldset");i.setAttribute("id","edit-project-inputs");const d=t.createTextInput("edit-project-title","edit-project-title",25,[]);d.value=r;const p=t.createTextarea("edit-project-desc","edit-project-desc",100,[]);p.value=a,i.append(d,p);const l=t.createSubmit("OK",["round-btn"]);c.addEventListener("submit",(e=>{((e,t)=>{const s=new FormData(e.target);for(const e of s)switch(e[0]){case"edit-project-title":var r=e[1];break;case"edit-project-desc":var a=e[1]}e.target.reset(),t.setTitle(r),t.setDesc(a),n.getProjectId(t),m(t),e.preventDefault()})(e,s)})),c.append(i,l),u.replaceWith(c)})),[...e.querySelector("#general-tabs").children].map((e=>e.addEventListener("click",a.bind(void 0)))),{renderProjectsTabs:t=>{const s=t.map((t=>{const s=e.createElement("li");return s.classList.add("tabs","project-tab"),s.textContent=t.getTitle(),s}));for(s.map(((e,s)=>e.addEventListener("click",m.bind(void 0,t[s],s))));c.firstChild;)c.removeChild(c.firstChild);s.map((e=>{c.appendChild(e)}))},renderTasks:r,initPageLoadTasks:()=>{let e=n.getAllTasks();r(e)},renderProjectsDetails:m}})(document),a=(t,s)=>{let a=[];const n={getTitle:()=>t,setTitle:e=>t=e,getDesc:()=>s,setDesc:e=>s=e,getTasks(){return this.tasks},getTask(e){return this.tasks[e]},createTask(t,s,a,n){this.tasks.push(e(t,s,a,n)),r.renderTasks(this.tasks)},deleteTask(e){const t=a.indexOf(e);a.splice(t,1),r.renderTasks(this.tasks)}};return Object.assign(Object.create(n),{tasks:a})},n=(()=>{let e=[];return{createProject:(t,s)=>{const n=a(t,s);return e.push(n),r.renderProjectsTabs(e),n},deleteProject:t=>{const s=e.indexOf(t);return e.splice(s,1),r.renderProjectsTabs(e),t},getProjects:()=>e,getProject:t=>e[t],getAllTasks:()=>e.reduce(((e,t)=>e.concat(t.getTasks())),[]),getProjectByTitle:t=>e.find((e=>e.getTitle()===t)),getProjectId:t=>e.indexOf(t)}})();n.createProject("One Project","One Proj Desc"),n.getProjects()[0].createTask("1 One Task TODAY THIS WEEK HIGH",1,1,"desc"),n.getProjects()[0].createTask("1 Two Task HIGH",-1,"desc",1),n.getProjects()[0].createTask("1 Three Task TODAY THIS WEEK",1,2,"desc"),n.createProject("Two Project","Two Proj Desc"),n.getProjects()[1].createTask("2 One Task THIS WEEK HIGH",2,1,"desc"),n.createProject("Three Project","Three Proj Desc"),n.getProjects()[2].createTask("3 One Task TODAY THIS WEEK ",1,3,"desc"),n.getProjects()[2].createTask("3 Two Task HIGH",-1,1,"desc");const c=(e=>{const s=e.querySelector("#body");return{createFormInput:(s,r,a,n)=>{const c=e.createElement("label");switch(c.classList.add("popup-labels"),c.setAttribute("for",r),a){case"text":c.textContent=s;const a=t.createTextInput(r,r,25,["popup-inputs","popup-inputs-text"]);c.appendChild(a);break;case"date":c.textContent=s;const o=e.createElement("input");o.setAttribute("type","date"),o.setAttribute("name",r),o.setAttribute("id",r),o.classList.add("popup-inputs","popup-inputs-date"),o.setAttribute("required",!0),c.appendChild(o);break;case"textarea":c.classList.add("popup-labels-textarea");const i=e.createElement("span");i.textContent=s;const d=e.createElement("span");d.classList.add("parenthesis"),d.textContent=" (up to 100 characters)",i.appendChild(d);const p=t.createTextarea(r,r,100,["popup-inputs","popup-textareas"]);c.append(i,p);break;case"fieldset":c.textContent=s;const l=e.createElement("fieldset");l.setAttribute("id",r),l.classList.add("popup-inputs"),n.map((e=>{e.firstElementChild.setAttribute("name",r),l.appendChild(e)})),c.appendChild(l);break;case"radio":c.classList.remove("popup-labels");const u={Low:3,Medium:2,High:1},m=e.createElement("input");m.setAttribute("type","radio"),m.setAttribute("id",r),m.classList.add("popup-inputs-radio"),m.setAttribute("value",u[s]),c.appendChild(m),c.append(s)}return c},createForm:(s,r,a)=>{const n=e.createElement("form");n.setAttribute("id",s),n.classList.add("popup-forms"),a.map((e=>{n.appendChild(e)}));const c=t.createSubmit(r,["popup-submits"]);return n.appendChild(c),n},createPopup:(t,s,r,a)=>{const n=e.createElement("section");n.setAttribute("id",t),n.classList.add("popups");const c=e.createElement("div");c.classList.add("popup-containers"),n.appendChild(c);const o=e.createElement("h3");o.textContent=s,o.classList.add("popup-titles");const i=e.createElement("button");return i.textContent="X",i.setAttribute("id",r),i.classList.add("popup-close-btns"),c.append(o,i,a),n},openPopup:e=>{s.appendChild(e),e.style.opacity=0,setTimeout((()=>{e.style.opacity=1}),500)},closePopup:e=>{e.style.opacity=0,setTimeout((()=>{s.removeChild(e)}),500)}}})(document);document.querySelector("#new-project-btn").addEventListener("click",c.openPopup.bind(void 0,(()=>{let e=[];const t=c.createFormInput("Project title:","new-project-title","text"),s=c.createFormInput("Project description:","new-project-desc","textarea");e.push(t,s);const a=c.createForm("new-project-form","Create a new project",e),o=c.createPopup("new-project-popup","New project","new-project-close-btn",a);return a.addEventListener("submit",(e=>{((e,t)=>{const s=new FormData(e.target);for(const e of s)switch(e[0]){case"new-project-title":var a=e[1];break;case"new-project-desc":var o=e[1]}e.target.reset(),n.createProject(a,o);const i=n.getProjectByTitle(a);r.renderProjectsDetails(i),e.preventDefault(),c.closePopup(t)})(e,o)})),o.querySelector("#new-project-close-btn").addEventListener("click",c.closePopup.bind(void 0,o)),o})()));const o=()=>{let e=[];const t=c.createFormInput("Task title:","new-task-title","text"),s=c.createFormInput("Due date:","new-task-duedate","date");let r=[];const a=c.createFormInput("Low","new-task-priority3","radio"),i=c.createFormInput("Medium","new-task-priority2","radio"),d=c.createFormInput("High","new-task-priority1","radio");r.push(a,i,d);const p=c.createFormInput("Priority:","new-task-priority","fieldset",r),l=c.createFormInput("Task description:","new-task-desc","textarea");e.push(t,s,p,l);const u=c.createForm("new-task-form","Create a new task",e);u.addEventListener("submit",(e=>{const t=new FormData(u);for(const e of t)switch(e[0]){case"new-task-title":var s=e[1];break;case"new-task-duedate":var r=e[1];break;case"new-task-priority":var a=e[1];break;case"new-task-desc":var o=e[1]}u.reset();const i=document.querySelector("#project-detail").dataset.projectId;n.getProject(i).createTask(s,r,a||3,o),e.preventDefault(),c.closePopup(m)}));const m=c.createPopup("new-task-popup","New task","new-task-close-btn",u);return m.querySelector("#new-task-close-btn").addEventListener("click",c.closePopup.bind(void 0,o)),m};document.querySelector("#new-task-btn").addEventListener("click",c.openPopup.bind(void 0,o())),console.log(n.getProjects()),r.initPageLoadTasks()})();