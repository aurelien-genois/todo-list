(()=>{"use strict";const e=(t=document,{createTextInput:(e,s,a,r,i,c)=>{const n=t.createElement("label");n.classList.add(...s),n.setAttribute("for",a);const o=t.createElement("input");return o.setAttribute("type","text"),o.setAttribute("id",a),o.setAttribute("name",r),o.setAttribute("maxlength",i),o.classList.add(...c),o.required=!0,i&&(o.placeholder=`(up to ${i} characters)`),n.append(e,o),n},createTextarea:(e,s,a,r,i,c)=>{const n=t.createElement("label");n.classList.add(...s),n.setAttribute("for",a);let o=e;const d=document.createElement("textarea");return d.setAttribute("id",a),d.setAttribute("name",r),d.setAttribute("maxlength",i),d.classList.add(...c),i&&(d.placeholder=`(up to ${i} characters)`),n.append(o,d),n},createDateInput:(e,s,a,r,i)=>{const c=t.createElement("label");c.classList.add(...s),c.setAttribute("for",a);const n=t.createElement("input");return n.setAttribute("type","date"),n.setAttribute("id",a),n.setAttribute("name",r),n.classList.add(...i),n.required=!0,c.append(e,n),c},createSelectOption:(e,s,a)=>{const r=t.createElement("option");return r.value=e,r.textContent=s,r.classList.add(...a),r},createSelect:(e,s,a,r,i,c)=>{const n=t.createElement("label");n.classList.add(...s),n.setAttribute("for",a);const o=t.createElement("select");return o.setAttribute("id",a),o.setAttribute("name",r),o.classList.add(...c),o.append(...i),n.append(e,o),n},createRadio:(e,s,a,r,i,c)=>{const n=t.createElement("label");n.classList.add(...s),n.setAttribute("for",a);const o=t.createElement("input");return o.setAttribute("type","radio"),o.setAttribute("id",a),o.setAttribute("name",r),o.classList.add(...c),o.setAttribute("value",i),n.append(o,e),n},createRadioFieldset:(e,s,a,r,i,c)=>{const n=t.createElement("label");n.classList.add(...s),n.setAttribute("for",a);const o=t.createElement("fieldset");return o.setAttribute("id",a),o.classList.add(...c),i.map((e=>{e.firstElementChild.setAttribute("name",r),o.appendChild(e)})),n.append(e,o),n},createSubmit:(e,s)=>{const a=t.createElement("input");return a.setAttribute("type","submit"),a.setAttribute("value",e),a.classList.add(...s),a},createForm:(s,a,r,i,c)=>{const n=t.createElement("form");n.setAttribute("id",s),n.classList.add(...a),Array.isArray(c)?c.map((e=>{n.appendChild(e)})):n.appendChild(c);const o=e.createSubmit(r,i);return n.appendChild(o),n}});var t;const s=(e=>{const t=e.querySelector("#body");return{createPopupSection:(t,s,a,r)=>{const i=e.createElement("section");i.setAttribute("id",t),i.classList.add("popups");const c=e.createElement("div");c.classList.add("popup-containers"),i.appendChild(c);const n=e.createElement("h3");n.textContent=s,n.classList.add("popup-titles");const o=e.createElement("button");return o.textContent="X",o.setAttribute("id",a),o.classList.add("popup-close-btns"),c.append(n,o,r),i},openPopup:e=>{t.appendChild(e),e.style.opacity=0,setTimeout((()=>{e.style.opacity=1}),500)},closePopup:e=>{e.style.opacity=0,setTimeout((()=>{t.removeChild(e)}),500)}}})(document),a=(document,{newProjectPopup:()=>{let t=[];const a=e.createTextInput("Project title:",["popup-labels"],"new-project-title","new-project-title",20,["popup-inputs","popup-inputs-text"]),i=e.createTextarea("Project description:",["popup-labels","popup-labels-textarea"],"new-project-desc","new-project-desc",100,["popup-inputs","popup-textareas"]);t.push(a,i);const c=e.createForm("new-project-form",["popup-forms"],"Create a new project",["popup-submits"],t),n=s.createPopupSection("new-project-popup","New project","new-project-close-btn",c);return c.addEventListener("submit",(e=>{r.createNewProjectFormSubmit(e,n)})),n.querySelector("#new-project-close-btn").addEventListener("click",s.closePopup.bind(void 0,n)),n},newTaskPopup:()=>{let t=[];const a=e.createTextInput("Task title:",["popup-labels"],"new-task-title","new-task-title",25,["popup-inputs","popup-inputs-text"]),i=e.createDateInput("Due date:",["popup-labels"],"new-task-duedate","new-task-duedate",["popup-inputs","popup-inputs-date"]),c=[e.createRadio("Low",[],"new-task-priority3","temp",3,["popup-inputs-radio"]),e.createRadio("Medium",[],"new-task-priority2","temp",2,["popup-inputs-radio"]),e.createRadio("High",[],"new-task-priority1","temp",1,["popup-inputs-radio"])],n=e.createRadioFieldset("Priority:",["popup-labels"],"new-task-priority","new-task-priority",c,["popup-inputs"]),o=e.createTextarea("Task description:",["popup-labels","popup-labels-textarea"],"new-task-desc","new-task-desc",100,["popup-inputs","popup-textareas"]);t.push(a,i,n,o);const d=e.createForm("new-task-form",["popup-forms"],"Create a new task",["popup-submits"],t);d.addEventListener("submit",(e=>{r.createNewTaskFormSubmit(e,p)}));const p=s.createPopupSection("new-task-popup","New task","new-task-close-btn",d);return p.querySelector("#new-task-close-btn").addEventListener("click",s.closePopup.bind(void 0,p)),p}}),r=(()=>{let e=[];const t=(t,s)=>{const a=o(t,s);return e.push(a),c.renderProjectsTabs(e),a},a=e=>{const t=new FormData(e);for(const e of t)switch(e[0]){case"new-project-title":var s=e[1];break;case"new-project-desc":var a=e[1];break;case"edit-project-title":s=e[1];break;case"edit-project-desc":a=e[1]}return e.reset(),{titleValue:s,descValue:a}},d=e=>{const t=new FormData(e);for(const e of t)switch(e[0]){case"new-task-title":var s=e[1];break;case"new-task-duedate":var a=e[1];break;case"new-task-priority":var r=e[1];break;case"new-task-desc":var i=e[1];break;case"edit-task-title":s=e[1];break;case"edit-task-duedate":a=e[1];break;case"edit-task-priority":r=e[1];break;case"edit-task-desc":i=e[1];break;case"edit-task-state":var c=e[1]}return e.reset(),{titleValue:s,dueDateValue:a,priorityValue:r,descValue:i,stateValue:c}};return{createProject:t,createNewProjectFormSubmit:(e,r)=>{const{titleValue:n,descValue:o}=a(e.target),d=t(n,o);c.renderProjectDetails(d),i.renderTasks(d.getTasks()),e.preventDefault(),s.closePopup(r)},editProjectFormSubmit:(t,s)=>{const{titleValue:r,descValue:i}=a(t.target);s.setTitle(r),s.setDesc(i),c.renderProjectDetails(s),c.renderProjectsTabs(e),t.preventDefault()},deleteProject:t=>{const s=e.indexOf(t);return e.splice(s,1),e.filter(((e,t)=>t>=s)).map((e=>{e.getTasks().map((e=>{e.setProjectId(e.getProjectId()-1)}))})),c.renderProjectsTabs(e),n.initPageLoadTasks(),c.renderProjectDetails("all-tasks","All tasks"),t},createNewTaskFormSubmit:(e,t)=>{const{titleValue:a,dueDateValue:i,priorityValue:c,descValue:n}=d(e.target),o=document.querySelector("#project-detail").dataset.projectId;r.getProject(o).createTask(a,i,c||3,n,o),e.preventDefault(),s.closePopup(t)},editTaskFormSubmit:(e,t,s,a)=>{const{titleValue:r,dueDateValue:c,priorityValue:o,descValue:p,stateValue:l}=d(e.target);t.setTitle(r),t.setDesc(p),t.setDueDate(c),t.setPriority(o),t.setState(l),isNaN(Number(a))?n.renderGeneralTabsTasks(a):i.renderTasks(s.getTasks()),e.preventDefault()},getProjects:()=>e,getProject:t=>e[t],getAllTasks:()=>e.reduce(((e,t)=>e.concat(t.getTasks())),[]),getProjectId:t=>e.indexOf(t)}})(),i=(t=>{const s=t.querySelector("#tasks-list"),a=t.querySelector("#project-detail"),i=c=>{const o=c.map(((s,c)=>{const o=r.getProject(s.getProjectId()).getTaskId(s);return((s,c,o,d,p,l,u)=>{const k=r.getProject(l),b=k.getTask(u),m=t.createElement("li");m.classList.add("tasks"),m.setAttribute("data-task-id",u),m.setAttribute("data-project-id",l);const T=t.createElement("input");T.type="checkbox",T.id="task-check-state","Done"===b.getState()&&(T.checked=!0),T.addEventListener("change",(()=>{const e=a.dataset.projectId;"Todo"===b.getState()?b.setState(0):b.setState(2),isNaN(Number(e))?n.renderGeneralTabsTasks(e):i(k.getTasks())}));const j=t.createElement("h3");j.textContent=s,j.classList.add("task-title");const g=t.createElement("div");g.classList.add("task-infos");const y=t.createElement("p");y.classList.add("task-duedate"),y.textContent=c;const P=t.createElement("p");P.classList.add("task-state"),P.textContent=d;const h=t.createElement("button");h.classList.add("task-expand-btn"),h.textContent="V",g.append(y,P,h),h.addEventListener("click",(()=>{m.querySelector(".task-expand")?(m.removeChild(E),h.textContent="V"):(m.append(E),h.textContent="A")}));const v=t.createElement("div");v.classList.add("task-main-infos"),v.append(T,j,g);const E=t.createElement("div");E.classList.add("task-expand");const S=t.createElement("div");S.classList.add("task-details");const w=t.createElement("p");w.classList.add("task-priority"),w.textContent=o;const L=t.createElement("p");L.classList.add("task-desc"),L.textContent=p,S.append(w,L);const D=t.createElement("div");D.classList.add("task-actions");const x=t.createElement("button");x.classList.add("edit-task-btn","round-btn"),x.textContent="/",x.addEventListener("click",(()=>{((s,i,c,n,o)=>{const d=t.createElement("fieldset");d.setAttribute("id","edit-task-main-infos");const p=e.createTextInput("",[],"edit-task-title","edit-task-title",25,[]);p.querySelector("input").value=i.getTitle();const l=t.createElement("fieldset");l.setAttribute("id","edit-task-date-state");const u=e.createDateInput("",[],"edit-task-duedate","edit-task-duedate",[]);u.querySelector("input").value=i.getDueDate();const k=[e.createSelectOption(0,"Done",[]),e.createSelectOption(1,"WIP",[]),e.createSelectOption(2,"Todo",[]),e.createSelectOption(3,"Abandoned",[])];k.map((e=>{e.textContent===i.getState()&&(e.selected=!0)}));const b=e.createSelect("",[],"edit-task-state","edit-task-state",k,[]);l.append(u,b),d.append(p,l);const m=t.createElement("div");m.setAttribute("id","edit-task-expand");const T=t.createElement("fieldset");T.setAttribute("id","edit-task-details");const j=[e.createRadio("Low",[],"edit-task-priority3","temp",3,["edit-inputs-radio"]),e.createRadio("Medium",[],"edit-task-priority2","temp",2,["edit-inputs-radio"]),e.createRadio("High",[],"edit-task-priority1","temp",1,["edit-inputs-radio"])];j.map((e=>{e.textContent===i.getPriority()&&(e.querySelector("input").checked=!0)}));const g=e.createRadioFieldset("Priority:",["edit-labels"],"edit-task-priority","edit-task-priority",j,["edit-inputs"]),y=e.createTextInput("",[],"edit-task-desc","edit-task-desc",25,[]);y.querySelector("input").value=i.getDesc(),T.append(g,y),m.append(T);const P=e.createForm("edit-task-form",[],"OK",["round-btn"],[d,m]);P.addEventListener("submit",(e=>{const t=a.dataset.projectId;r.editTaskFormSubmit(e,i,s,t)})),c.removeChild(n),c.removeChild(o),c.append(P)})(k,b,m,v,E)}));const A=t.createElement("button");return A.classList.add("round-btn","delete-task-btn"),A.textContent="X",A.addEventListener("click",(()=>{const e=a.dataset.projectId;k.deleteTask(u,e)})),D.append(x,A),E.append(S,D),m.append(v),m})(s.getTitle(),s.getDueDate(),s.getPriority(),s.getState(),s.getDesc(),s.getProjectId(),o)}));for(;s.firstChild;)s.removeChild(s.firstChild);o.map((e=>{s.appendChild(e)}))};return{renderTasks:i}})(document),c=(t=>{const c=t.querySelector("#projects-tabs"),n=t.querySelector("#project-detail"),o=t.querySelector("#project-title"),d=t.querySelector("#project-desc"),p=document.querySelector("#new-project-btn"),l=t.querySelector("#new-task-btn"),u=t.querySelector("#edit-project-btn"),k=t.querySelector("#delete-project-btn");l.style.visibility="hidden",u.style.visibility="hidden";const b=t.querySelector("#project-infos");k.style.visibility="hidden",p.addEventListener("click",s.openPopup.bind(void 0,a.newProjectPopup())),l.addEventListener("click",s.openPopup.bind(void 0,a.newTaskPopup()));const m=(e,s)=>{if(t.querySelector("#edit-project-form")&&t.querySelector("#edit-project-form").replaceWith(b),"string"==typeof e)o.textContent=s,d.textContent="",n.setAttribute("data-project-id",e),l.style.visibility="hidden",u.style.visibility="hidden",k.style.visibility="hidden";else{o.textContent=e.getTitle(),d.textContent=e.getDesc();const t=r.getProjectId(e);n.setAttribute("data-project-id",t),l.style.visibility="visible",u.style.visibility="visible",k.style.visibility="visible"}};return u.addEventListener("click",(()=>{const s=r.getProject(n.dataset.projectId),a=t.createElement("fieldset");a.setAttribute("id","edit-project-inputs");const i=e.createTextInput("",[],"edit-project-title","edit-project-title",20,[]);i.querySelector("input").value=s.getTitle();const c=e.createTextarea("",[],"edit-project-desc","edit-project-desc",100,[]);c.querySelector("textarea").value=s.getDesc(),a.append(i,c);const o=e.createForm("edit-project-form",[],"OK",["round-btn"],a);o.addEventListener("submit",(e=>{r.editProjectFormSubmit(e,s)})),b.replaceWith(o)})),k.addEventListener("click",(()=>{const e=r.getProject(n.dataset.projectId);r.deleteProject(e)})),{renderProjectsTabs:e=>{const s=e.map((e=>{const s=t.createElement("li");return s.classList.add("tabs","project-tab"),s.textContent=e.getTitle(),s}));for(s.map(((t,s)=>t.addEventListener("click",(()=>{const t=e[s];i.renderTasks(t.getTasks()),m(t)}))));c.firstChild;)c.removeChild(c.firstChild);s.map((e=>{c.appendChild(e)}))},renderProjectDetails:m}})(document),n=(e=>{const t=e=>{let t=r.getAllTasks(),s=[];switch(e){case"today":s=t.filter((e=>1===e.getDueDate()));break;case"this-week":s=t.filter((e=>e.getDueDate()>0));break;case"high-priority":s=t.filter((e=>"High"===e.getPriority()));break;case"all-tasks":s=[...t]}i.renderTasks(s)};return[...e.querySelector("#general-tabs").children].map((e=>e.addEventListener("click",(e=>{const s=e.target.dataset.tab,a=e.target.textContent;t(s),c.renderProjectDetails(s,a)})))),{initPageLoadTasks:()=>{let e=r.getAllTasks();i.renderTasks(e)},renderGeneralTabsTasks:t}})(document),o=(e,t)=>{const s={getTitle:()=>e,setTitle:t=>e=t,getDesc:()=>t,setDesc:e=>t=e,getTasks(){return this.tasks},getTask(e){return this.tasks[e]},getTaskId(e){return this.tasks.indexOf(e)},createTask(e,t,s,a,r){this.tasks.push(d(e,t,s,a,r)),i.renderTasks(this.tasks)},deleteTask(e,t){this.tasks.splice(e,1),isNaN(Number(t))?n.renderGeneralTabsTasks(t):i.renderTasks(this.tasks)}};return Object.assign(Object.create(s),{tasks:[]})},d=(e,t,s,a,r)=>{const i={getTitle:()=>e,setTitle:t=>e=t,getDueDate:()=>t,setDueDate:e=>t=e,getDesc:()=>a,setDesc:e=>a=e,getProjectId:()=>r,setProjectId:e=>r=e,taskPriorities:["High","Medium","Low"],getPriority(){return this.taskPriorities[s-1]},setPriority(e){s=e},taskStates:["Done","WIP","Todo","Abandoned"],getState(){return this.taskStates[this.stateDegree]},setState(e){this.stateDegree=e}};return Object.assign(Object.create(i),{stateDegree:2})};r.createProject("One Project","One Proj Desc"),r.getProjects()[0].createTask("1 One Task TODAY THIS WEEK HIGH",1,1,"desc",0),r.getProjects()[0].createTask("1 Two Task HIGH",-1,1,"desc",0),r.getProjects()[0].createTask("1 Three Task TODAY THIS WEEK",1,2,"desc",0),r.createProject("Two Project","Two Proj Desc"),r.getProjects()[1].createTask("2 One Task THIS WEEK HIGH",2,1,"desc",1),r.createProject("Three Project","Three Proj Desc"),r.getProjects()[2].createTask("3 One Task TODAY THIS WEEK ",1,3,"desc",2),r.getProjects()[2].createTask("3 Two Task HIGH",-1,1,"desc",2),console.log(r.getProjects()),n.initPageLoadTasks()})();