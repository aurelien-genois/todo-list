(()=>{"use strict";const e=(e,t,s,r)=>{const a={getTitle:()=>e,setTitle:t=>e=t,getDueDate:()=>t,setDueDate:e=>t=e,getDesc:()=>r,setDesc:e=>r=e,taskPriorities:["High","Medium","Low"],getPriority(){return this.taskPriorities[s-1]},setPriority(e){s=e},taskStates:["Done","WIP","Todo","Abandoned"],getState(){return this.taskStates[this.stateDegree-1]},setState(e){this.stateDegree=e}};return Object.assign(Object.create(a),{stateDegree:3})},t=(s=document,{createTextarea:(e,t,s,r)=>{const a=document.createElement("textarea");return a.setAttribute("id",e),a.setAttribute("name",t),a.setAttribute("maxlength",s),a.classList.add(...r),a},createTextInput:(e,t,r,a)=>{const n=s.createElement("input");return n.setAttribute("type","text"),n.setAttribute("id",e),n.setAttribute("name",t),n.setAttribute("maxlength",r),n.classList.add(...a),n.setAttribute("required",!0),n},createSubmit:(e,t)=>{const r=s.createElement("input");return r.setAttribute("type","submit"),r.setAttribute("value",e),r.classList.add(...t),r}});var s;const r=(e=>{const t=e.querySelector("#tasks-list"),s=()=>{li.querySelector(".task-expand")?(li.removeChild(expandDiv),expandBtn.textContent="V"):(li.append(expandDiv),expandBtn.textContent="A")};return{renderTasks:r=>{const a=r.map((t=>((t,r,a,n,c)=>{const i=e.createElement("li");i.classList.add("tasks");const o=e.createElement("h3");o.textContent=t,o.classList.add("task-title");const d=e.createElement("div");d.classList.add("task-infos");const l=e.createElement("p");l.classList.add("task-duedate"),l.textContent=r;const p=e.createElement("p");p.classList.add("task-state"),p.textContent=n;const u=e.createElement("button");u.classList.add("task-expand-btn"),u.textContent="V",d.append(l,p,u),u.addEventListener("click",s);const k=e.createElement("div");k.classList.add("task-main-infos"),k.append(o,d);const b=e.createElement("div");b.classList.add("task-expand");const m=e.createElement("div");m.classList.add("task-details");const j=e.createElement("p");j.classList.add("task-priority"),j.textContent=a;const T=e.createElement("p");T.classList.add("task-desc"),T.textContent=c,m.append(j,T);const g=e.createElement("div");g.classList.add("task-actions");const h=e.createElement("button");h.classList.add("edit-task-btn","round-btn"),h.textContent="/",h.addEventListener("click",(()=>{}));const y=e.createElement("button");return y.classList.add("round-btn","delete-task-btn"),y.textContent="X",y.addEventListener("click",(()=>{})),g.append(h,y),b.append(m,g),i.append(k),i})(t.getTitle(),t.getDueDate(),t.getPriority(),t.getState(),t.getDesc())));for(;t.firstChild;)t.removeChild(t.firstChild);a.map((e=>{t.appendChild(e)}))}}})(document),a=(e=>{const s=e.querySelector("#projects-tabs"),a=e.querySelector("#project-detail"),n=e.querySelector("#project-title"),c=e.querySelector("#project-desc"),i=e.querySelector("#new-task-btn"),o=e.querySelector("#edit-project-btn"),l=e.querySelector("#delete-project-btn");i.style.visibility="hidden",o.style.visibility="hidden";const p=e.querySelector("#project-infos");l.style.visibility="hidden";const u=(t,s)=>{if(e.querySelector("#edit-project-form")&&e.querySelector("#edit-project-form").replaceWith(p),"general"===t)n.textContent=s,c.textContent="",a.removeAttribute("data-project-id"),i.style.visibility="hidden",o.style.visibility="hidden",l.style.visibility="hidden";else{n.textContent=t.getTitle(),c.textContent=t.getDesc();const e=d.getProjectId(t);a.setAttribute("data-project-id",e),i.style.visibility="visible",o.style.visibility="visible",l.style.visibility="visible"}};return o.addEventListener("click",(()=>{const s=d.getProject(a.dataset.projectId),r=s.getTitle(),n=s.getDesc(),c=e.createElement("form");c.setAttribute("id","edit-project-form");const i=e.createElement("fieldset");i.setAttribute("id","edit-project-inputs");const o=t.createTextInput("edit-project-title","edit-project-title",25,[]);o.value=r;const l=t.createTextarea("edit-project-desc","edit-project-desc",100,[]);l.value=n,i.append(o,l);const u=t.createSubmit("OK",["round-btn"]);c.addEventListener("submit",(e=>{d.editProjectFormSubmit(e,s)})),c.append(i,u),p.replaceWith(c)})),l.addEventListener("click",(()=>{const e=d.getProject(a.dataset.projectId);console.log(a.dataset.projectId),d.deleteProject(e)})),{renderProjectsTabs:t=>{const a=t.map((t=>{const s=e.createElement("li");return s.classList.add("tabs","project-tab"),s.textContent=t.getTitle(),s}));for(a.map(((e,s)=>e.addEventListener("click",(()=>{const e=t[s];r.renderTasks(e.getTasks()),u(e)}))));s.firstChild;)s.removeChild(s.firstChild);a.map((e=>{s.appendChild(e)}))},renderProjectDetails:u}})(document),n=(e=>{const t=e=>{let t=d.getAllTasks(),s=[];switch(e.target.dataset.tab){case"today":s=t.filter((e=>1===e.getDueDate()));break;case"this-week":s=t.filter((e=>e.getDueDate()>0));break;case"high-priority":s=t.filter((e=>"High"===e.getPriority()));break;case"all-tasks":s=[...t]}r.renderTasks(s),a.renderProjectDetails("general",e.target.textContent)};return[...e.querySelector("#general-tabs").children].map((e=>e.addEventListener("click",t))),{initPageLoadTasks:()=>{let e=d.getAllTasks();r.renderTasks(e)}}})(document),c=(t,s)=>{let a=[];const n={getTitle:()=>t,setTitle:e=>t=e,getDesc:()=>s,setDesc:e=>s=e,getTasks(){return this.tasks},getTask(e){return this.tasks[e]},getTaskId(e){return this.tasks.indexOf(c)},createTask(t,s,a,n){this.tasks.push(e(t,s,a,n)),r.renderTasks(this.tasks)},deleteTask(e){const t=a.indexOf(e);a.splice(t,1),r.renderTasks(this.tasks)}};return Object.assign(Object.create(n),{tasks:a})},i=(e=>{const s=e.querySelector("#body");return{createFormInput:(s,r,a,n)=>{const c=e.createElement("label");switch(c.classList.add("popup-labels"),c.setAttribute("for",r),a){case"text":c.textContent=s;const a=t.createTextInput(r,r,25,["popup-inputs","popup-inputs-text"]);c.appendChild(a);break;case"date":c.textContent=s;const i=e.createElement("input");i.setAttribute("type","date"),i.setAttribute("name",r),i.setAttribute("id",r),i.classList.add("popup-inputs","popup-inputs-date"),i.setAttribute("required",!0),c.appendChild(i);break;case"textarea":c.classList.add("popup-labels-textarea");const o=e.createElement("span");o.textContent=s;const d=e.createElement("span");d.classList.add("parenthesis"),d.textContent=" (up to 100 characters)",o.appendChild(d);const l=t.createTextarea(r,r,100,["popup-inputs","popup-textareas"]);c.append(o,l);break;case"fieldset":c.textContent=s;const p=e.createElement("fieldset");p.setAttribute("id",r),p.classList.add("popup-inputs"),n.map((e=>{e.firstElementChild.setAttribute("name",r),p.appendChild(e)})),c.appendChild(p);break;case"radio":c.classList.remove("popup-labels");const u={Low:3,Medium:2,High:1},k=e.createElement("input");k.setAttribute("type","radio"),k.setAttribute("id",r),k.classList.add("popup-inputs-radio"),k.setAttribute("value",u[s]),c.appendChild(k),c.append(s)}return c},createForm:(s,r,a)=>{const n=e.createElement("form");n.setAttribute("id",s),n.classList.add("popup-forms"),a.map((e=>{n.appendChild(e)}));const c=t.createSubmit(r,["popup-submits"]);return n.appendChild(c),n},createPopup:(t,s,r,a)=>{const n=e.createElement("section");n.setAttribute("id",t),n.classList.add("popups");const c=e.createElement("div");c.classList.add("popup-containers"),n.appendChild(c);const i=e.createElement("h3");i.textContent=s,i.classList.add("popup-titles");const o=e.createElement("button");return o.textContent="X",o.setAttribute("id",r),o.classList.add("popup-close-btns"),c.append(i,o,a),n},openPopup:e=>{s.appendChild(e),e.style.opacity=0,setTimeout((()=>{e.style.opacity=1}),500)},closePopup:e=>{e.style.opacity=0,setTimeout((()=>{s.removeChild(e)}),500)}}})(document);document.querySelector("#new-project-btn").addEventListener("click",i.openPopup.bind(void 0,(()=>{let e=[];const t=i.createFormInput("Project title:","new-project-title","text"),s=i.createFormInput("Project description:","new-project-desc","textarea");e.push(t,s);const r=i.createForm("new-project-form","Create a new project",e),a=i.createPopup("new-project-popup","New project","new-project-close-btn",r);return r.addEventListener("submit",(e=>{d.createNewProjectFormSubmit(e,a)})),a.querySelector("#new-project-close-btn").addEventListener("click",i.closePopup.bind(void 0,a)),a})()));const o=()=>{let e=[];const t=i.createFormInput("Task title:","new-task-title","text"),s=i.createFormInput("Due date:","new-task-duedate","date");let r=[];const a=i.createFormInput("Low","new-task-priority3","radio"),n=i.createFormInput("Medium","new-task-priority2","radio"),c=i.createFormInput("High","new-task-priority1","radio");r.push(a,n,c);const l=i.createFormInput("Priority:","new-task-priority","fieldset",r),p=i.createFormInput("Task description:","new-task-desc","textarea");e.push(t,s,l,p);const u=i.createForm("new-task-form","Create a new task",e);u.addEventListener("submit",(e=>{const t=new FormData(u);for(const e of t)switch(e[0]){case"new-task-title":var s=e[1];break;case"new-task-duedate":var r=e[1];break;case"new-task-priority":var a=e[1];break;case"new-task-desc":var n=e[1]}u.reset();const c=document.querySelector("#project-detail").dataset.projectId;d.getProject(c).createTask(s,r,a||3,n),e.preventDefault(),i.closePopup(k)}));const k=i.createPopup("new-task-popup","New task","new-task-close-btn",u);return k.querySelector("#new-task-close-btn").addEventListener("click",i.closePopup.bind(void 0,o)),k};document.querySelector("#new-task-btn").addEventListener("click",i.openPopup.bind(void 0,o()));const d=(()=>{let e=[];const t=(t,s)=>{const r=c(t,s);return e.push(r),a.renderProjectsTabs(e),r},s=e=>{const t=new FormData(e);for(const e of t)switch(e[0]){case"new-project-title":var s=e[1];break;case"new-project-desc":var r=e[1];break;case"edit-project-title":s=e[1];break;case"edit-project-desc":r=e[1]}return e.reset(),{titleValue:s,descValue:r}};return{createProject:t,createNewProjectFormSubmit:(e,n)=>{const{titleValue:c,descValue:o}=s(e.target),d=t(c,o);a.renderProjectDetails(d),r.renderTasks(d.getTasks()),e.preventDefault(),i.closePopup(n)},editProjectFormSubmit:(e,t)=>{const{titleValue:r,descValue:n}=s(e.target);t.setTitle(r),t.setDesc(n),a.renderProjectDetails(t),e.preventDefault()},deleteProject:t=>{const s=e.indexOf(t);return e.splice(s,1),a.renderProjectsTabs(e),t},getProjects:()=>e,getProject:t=>e[t],getAllTasks:()=>e.reduce(((e,t)=>e.concat(t.getTasks())),[]),getProjectId:t=>e.indexOf(t)}})();d.createProject("One Project","One Proj Desc"),d.getProjects()[0].createTask("1 One Task TODAY THIS WEEK HIGH",1,1,"desc"),d.getProjects()[0].createTask("1 Two Task HIGH",-1,"desc",1),d.getProjects()[0].createTask("1 Three Task TODAY THIS WEEK",1,2,"desc"),d.createProject("Two Project","Two Proj Desc"),d.getProjects()[1].createTask("2 One Task THIS WEEK HIGH",2,1,"desc"),d.createProject("Three Project","Three Proj Desc"),d.getProjects()[2].createTask("3 One Task TODAY THIS WEEK ",1,3,"desc"),d.getProjects()[2].createTask("3 Two Task HIGH",-1,1,"desc"),console.log(d.getProjects()),n.initPageLoadTasks()})();