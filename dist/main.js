(()=>{"use strict";const e=(e,t,s,a,r)=>{const i={getTitle:()=>e,setTitle:t=>e=t,getDueDate:()=>t,setDueDate:e=>t=e,getDesc:()=>a,setDesc:e=>a=e,getProjectId:()=>r,setProjectId:e=>r=e,taskPriorities:["High","Medium","Low"],getPriority(){return this.taskPriorities[s-1]},setPriority(e){s=e},taskStates:["Done","WIP","Todo","Abandoned"],getState(){return this.taskStates[this.stateDegree]},setState(e){this.stateDegree=e}};return Object.assign(Object.create(i),{stateDegree:2})},t=(e=>{const t=(t,s)=>{const a=e.createElement("input");return a.setAttribute("type","submit"),a.setAttribute("value",t),a.classList.add(...s),a};return{createTextInput:(t,s,a,r,i,c)=>{const n=e.createElement("label");n.classList.add(...s),n.setAttribute("for",a);const o=e.createElement("input");return o.setAttribute("type","text"),o.setAttribute("id",a),o.setAttribute("name",r),o.setAttribute("maxlength",i),o.classList.add(...c),o.required=!0,i&&(o.placeholder=`(up to ${i} characters)`),n.append(t,o),n},createTextarea:(t,s,a,r,i,c)=>{const n=e.createElement("label");n.classList.add(...s),n.setAttribute("for",a);let o=t;const d=document.createElement("textarea");return d.setAttribute("id",a),d.setAttribute("name",r),d.setAttribute("maxlength",i),d.classList.add(...c),i&&(d.placeholder=`(up to ${i} characters)`),n.append(o,d),n},createDateInput:(t,s,a,r,i)=>{const c=e.createElement("label");c.classList.add(...s),c.setAttribute("for",a);const n=e.createElement("input");return n.setAttribute("type","date"),n.setAttribute("id",a),n.setAttribute("name",r),n.classList.add(...i),n.required=!0,c.append(t,n),c},createSelectOption:(t,s,a)=>{const r=e.createElement("option");return r.value=t,r.textContent=s,r.classList.add(...a),r},createSelect:(t,s,a,r,i,c)=>{const n=e.createElement("label");n.classList.add(...s),n.setAttribute("for",a);const o=e.createElement("select");return o.setAttribute("id",a),o.setAttribute("name",r),o.classList.add(...c),o.append(...i),n.append(t,o),n},createRadio:(t,s,a,r,i,c)=>{const n=e.createElement("label");n.classList.add(...s),n.setAttribute("for",a);const o=e.createElement("input");return o.setAttribute("type","radio"),o.setAttribute("id",a),o.setAttribute("name",r),o.classList.add(...c),o.setAttribute("value",i),n.append(o,t),n},createRadioFieldset:(t,s,a,r,i,c)=>{const n=e.createElement("label");n.classList.add(...s),n.setAttribute("for",a);const o=e.createElement("fieldset");return o.setAttribute("id",a),o.classList.add(...c),i.map((e=>{e.firstElementChild.setAttribute("name",r),o.appendChild(e)})),n.append(t,o),n},createSubmit:t,createForm:(s,a,r,i,c)=>{const n=e.createElement("form");n.setAttribute("id",s),n.classList.add(...a),Array.isArray(c)?c.map((e=>{n.appendChild(e)})):n.appendChild(c);const o=t(r,i);return n.appendChild(o),n}}})(document),s={createH:(e,t,s,r)=>{const i=a.createElement("h"+r);return i.textContent=s,i.id=e,i.classList.add(...t),i},createButton:(e,t,s)=>{const r=a.createElement("button");return r.textContent=s,r.setAttribute("id",e),r.classList.add(...t),r},createDiv:(e,t,s)=>{const r=a.createElement("div");return r.id=e,r.classList.add(...t),s.map((e=>{r.append(e)})),r},createSection:(e,t,s)=>{const r=a.createElement("section");return r.id=e,r.classList.add(...t),s.map((e=>{r.append(e)})),r},body:(a=document).querySelector("#body")};var a;const r={createPopupSection:(e,t,a,r)=>{const i=s.createH("",["popup-titles"],t,3),c=s.createButton(a,["popup-close-btns"],"X"),n=s.createDiv("",["popup-containers"],[i,c,r]);return s.createSection(e,["popups"],[n])},openPopup:e=>{s.body.appendChild(e),e.style.opacity=0,setTimeout((()=>{e.style.opacity=1}),500)},closePopup:e=>{e.style.opacity=0,setTimeout((()=>{s.body.removeChild(e)}),500)}},i=()=>{let e=[];const s=t.createTextInput("Project title:",["popup-labels"],"new-project-title","new-project-title",20,["popup-inputs","popup-inputs-text"]),a=t.createTextarea("Project description:",["popup-labels","popup-labels-textarea"],"new-project-desc","new-project-desc",100,["popup-inputs","popup-textareas"]);e.push(s,a);const i=t.createForm("new-project-form",["popup-forms"],"Create a new project",["popup-submits"],e);i.addEventListener("submit",(e=>{p.createNewProjectFormSubmit(e,c)}));const c=r.createPopupSection("new-project-popup","New project","new-project-close-btn",i);return c.querySelector("#new-project-close-btn").addEventListener("click",r.closePopup.bind(void 0,c)),c},c=e=>{let s=[];const a=t.createTextInput("Task title:",["popup-labels"],"new-task-title","new-task-title",15,["popup-inputs","popup-inputs-text"]),i=t.createDateInput("Due date:",["popup-labels"],"new-task-duedate","new-task-duedate",["popup-inputs","popup-inputs-date"]),c=[t.createRadio("Low",[],"new-task-priority3","temp",3,["popup-inputs-radio"]),t.createRadio("Medium",[],"new-task-priority2","temp",2,["popup-inputs-radio"]),t.createRadio("High",[],"new-task-priority1","temp",1,["popup-inputs-radio"])],n=t.createRadioFieldset("Priority:",["popup-labels"],"new-task-priority","new-task-priority",c,["popup-inputs"]),o=t.createTextarea("Task description:",["popup-labels","popup-labels-textarea"],"new-task-desc","new-task-desc",100,["popup-inputs","popup-textareas"]);s.push(a,i,n,o);const d=t.createForm("new-task-form",["popup-forms"],"Create a new task",["popup-submits"],s);d.addEventListener("submit",(t=>{p.createNewTaskFormSubmit(t,l,e)}));const l=r.createPopupSection("new-task-popup","New task","new-task-close-btn",d);return l.querySelector("#new-task-close-btn").addEventListener("click",r.closePopup.bind(void 0,l)),l},n=(e=>{const s=e.querySelector("#tasks-list"),a=e.querySelector("#project-detail"),r=i=>{const c=i.map(((s,i)=>{const c=p.getProject(s.getProjectId()).getTaskId(s);return((s,i,c,n,o,l,u)=>{const k=p.getProject(l),b=k.getTask(u),m=e.createElement("li");m.classList.add("tasks"),m.setAttribute("data-task-id",u),m.setAttribute("data-project-id",l);const T=e.createElement("input");T.type="checkbox",T.id="task-check-state","Done"===b.getState()&&(T.checked=!0),T.addEventListener("change",(()=>{const e=a.dataset.projectId;"Todo"===b.getState()?b.setState(0):b.setState(2),isNaN(Number(e))?d.renderGeneralTabsTasks(e):r(k.getTasks())}));const j=e.createElement("h3");j.textContent=s,j.classList.add("task-title");const g=e.createElement("div");g.classList.add("task-infos");const y=e.createElement("p");y.classList.add("task-duedate"),y.textContent=i;const P=e.createElement("p");P.classList.add("task-state"),P.textContent=n;const h=e.createElement("button");h.classList.add("task-expand-btn"),h.textContent="V",g.append(y,P,h),h.addEventListener("click",(()=>{m.querySelector(".task-expand")?(m.removeChild(E),h.textContent="V"):(m.append(E),h.textContent="A")}));const v=e.createElement("div");v.classList.add("task-main-infos"),v.append(T,j,g);const E=e.createElement("div");E.classList.add("task-expand");const S=e.createElement("div");S.classList.add("task-details");const D=e.createElement("p");D.classList.add("task-priority"),D.textContent=c;const L=e.createElement("p");L.classList.add("task-desc"),L.textContent=o,S.append(D,L);const w=e.createElement("div");w.classList.add("task-actions");const x=e.createElement("button");x.classList.add("edit-task-btn","round-btn"),x.textContent="/",x.addEventListener("click",(()=>{((s,r,i,c,n)=>{const o=e.createElement("fieldset");o.setAttribute("id","edit-task-main-infos");const d=t.createTextInput("",[],"edit-task-title","edit-task-title",15,[]);d.querySelector("input").value=r.getTitle();const l=e.createElement("fieldset");l.setAttribute("id","edit-task-date-state");const u=t.createDateInput("",[],"edit-task-duedate","edit-task-duedate",[]);u.querySelector("input").value=r.getDueDate();const k=[t.createSelectOption(0,"Done",[]),t.createSelectOption(1,"WIP",[]),t.createSelectOption(2,"Todo",[]),t.createSelectOption(3,"Abandoned",[])];k.map((e=>{e.textContent===r.getState()&&(e.selected=!0)}));const b=t.createSelect("",[],"edit-task-state","edit-task-state",k,[]);l.append(u,b),o.append(d,l);const m=e.createElement("div");m.setAttribute("id","edit-task-expand");const T=e.createElement("fieldset");T.setAttribute("id","edit-task-details");const j=[t.createRadio("Low",[],"edit-task-priority3","temp",3,["edit-inputs-radio"]),t.createRadio("Medium",[],"edit-task-priority2","temp",2,["edit-inputs-radio"]),t.createRadio("High",[],"edit-task-priority1","temp",1,["edit-inputs-radio"])];j.map((e=>{e.textContent===r.getPriority()&&(e.querySelector("input").checked=!0)}));const g=t.createRadioFieldset("Priority:",["edit-labels"],"edit-task-priority","edit-task-priority",j,["edit-inputs"]),y=t.createTextInput("",[],"edit-task-desc","edit-task-desc",25,[]);y.querySelector("input").value=r.getDesc(),T.append(g,y),m.append(T);const P=t.createForm("edit-task-form",[],"OK",["round-btn"],[o,m]);P.addEventListener("submit",(e=>{const t=a.dataset.projectId;p.editTaskFormSubmit(e,r,s,t)})),i.removeChild(c),i.removeChild(n),i.append(P)})(k,b,m,v,E)}));const A=e.createElement("button");return A.classList.add("round-btn","delete-task-btn"),A.textContent="X",A.addEventListener("click",(()=>{const e=a.dataset.projectId;k.deleteTask(u,e)})),w.append(x,A),E.append(S,w),m.append(v),m})(s.getTitle(),s.getDueDate(),s.getPriority(),s.getState(),s.getDesc(),s.getProjectId(),c)}));for(;s.firstChild;)s.removeChild(s.firstChild);c.map((e=>{s.appendChild(e)}))};return{renderTasks:r}})(document),o=(e=>{const s=e.querySelector("#projects-tabs"),a=e.querySelector("#project-detail"),o=e.querySelector("#project-title"),d=e.querySelector("#project-desc"),l=document.querySelector("#new-project-btn"),u=e.querySelector("#new-task-btn"),k=e.querySelector("#edit-project-btn"),b=e.querySelector("#delete-project-btn");u.style.visibility="hidden",k.style.visibility="hidden";const m=e.querySelector("#project-infos");b.style.visibility="hidden",l.addEventListener("click",r.openPopup.bind(void 0,i())),u.addEventListener("click",(()=>{const e=a.dataset.projectId,t=c(e);r.openPopup(t)}));const T=(t,s)=>{if(e.querySelector("#edit-project-form")&&e.querySelector("#edit-project-form").replaceWith(m),"string"==typeof t)o.textContent=s,d.textContent="",a.setAttribute("data-project-id",t),u.style.visibility="hidden",k.style.visibility="hidden",b.style.visibility="hidden";else{o.textContent=t.getTitle(),d.textContent=t.getDesc();const e=p.getProjectId(t);a.setAttribute("data-project-id",e),u.style.visibility="visible",k.style.visibility="visible",b.style.visibility="visible"}};return k.addEventListener("click",(()=>{const s=p.getProject(a.dataset.projectId),r=e.createElement("fieldset");r.setAttribute("id","edit-project-inputs");const i=t.createTextInput("",[],"edit-project-title","edit-project-title",20,[]);i.querySelector("input").value=s.getTitle();const c=t.createTextarea("",[],"edit-project-desc","edit-project-desc",100,[]);c.querySelector("textarea").value=s.getDesc(),r.append(i,c);const n=t.createForm("edit-project-form",[],"OK",["round-btn"],r);n.addEventListener("submit",(e=>{p.editProjectFormSubmit(e,s)})),m.replaceWith(n)})),b.addEventListener("click",(()=>{const e=p.getProject(a.dataset.projectId);p.deleteProject(e)})),{renderProjectsTabs:t=>{const a=t.map((t=>{const s=e.createElement("li");return s.classList.add("tabs","project-tab"),s.textContent=t.getTitle(),s}));for(a.map(((e,s)=>e.addEventListener("click",(()=>{const e=t[s];n.renderTasks(e.getTasks()),T(e)}))));s.firstChild;)s.removeChild(s.firstChild);a.map((e=>{s.appendChild(e)}))},renderProjectDetails:T}})(document),d=(e=>{const t=e=>{let t=p.getAllTasks(),s=[];switch(e){case"today":s=t.filter((e=>1===e.getDueDate()));break;case"this-week":s=t.filter((e=>e.getDueDate()>0));break;case"high-priority":s=t.filter((e=>"High"===e.getPriority()));break;case"all-tasks":s=[...t]}n.renderTasks(s)};return[...e.querySelector("#general-tabs").children].map((e=>e.addEventListener("click",(e=>{const s=e.target.dataset.tab,a=e.target.textContent;t(s),o.renderProjectDetails(s,a)})))),{initPageLoadTasks:()=>{let e=p.getAllTasks();n.renderTasks(e)},renderGeneralTabsTasks:t}})(document),l=(t,s)=>{const a={getTitle:()=>t,setTitle:e=>t=e,getDesc:()=>s,setDesc:e=>s=e,getTasks(){return this.tasks},getTask(e){return this.tasks[e]},getTaskId(e){return this.tasks.indexOf(e)},createTask(t,s,a,r,i){this.tasks.push(e(t,s,a,r,i)),n.renderTasks(this.tasks)},deleteTask(e,t){this.tasks.splice(e,1),isNaN(Number(t))?d.renderGeneralTabsTasks(t):n.renderTasks(this.tasks)}};return Object.assign(Object.create(a),{tasks:[]})},p=(()=>{let e=[];const t=(t,s)=>{const a=l(t,s);return e.push(a),o.renderProjectsTabs(e),a},s=e=>{const t=new FormData(e);for(const e of t)switch(e[0]){case"new-project-title":var s=e[1];break;case"new-project-desc":var a=e[1];break;case"edit-project-title":s=e[1];break;case"edit-project-desc":a=e[1]}return e.reset(),{titleValue:s,descValue:a}},a=e=>{const t=new FormData(e);for(const e of t)switch(e[0]){case"new-task-title":var s=e[1];break;case"new-task-duedate":var a=e[1];break;case"new-task-priority":var r=e[1];break;case"new-task-desc":var i=e[1];break;case"edit-task-title":s=e[1];break;case"edit-task-duedate":a=e[1];break;case"edit-task-priority":r=e[1];break;case"edit-task-desc":i=e[1];break;case"edit-task-state":var c=e[1]}return e.reset(),{titleValue:s,dueDateValue:a,priorityValue:r,descValue:i,stateValue:c}};return{createProject:t,createNewProjectFormSubmit:(e,a)=>{const{titleValue:i,descValue:c}=s(e.target),d=t(i,c);o.renderProjectDetails(d),n.renderTasks(d.getTasks()),e.preventDefault(),r.closePopup(a)},editProjectFormSubmit:(t,a)=>{const{titleValue:r,descValue:i}=s(t.target);a.setTitle(r),a.setDesc(i),o.renderProjectDetails(a),o.renderProjectsTabs(e),t.preventDefault()},deleteProject:t=>{const s=e.indexOf(t);return e.splice(s,1),e.filter(((e,t)=>t>=s)).map((e=>{e.getTasks().map((e=>{e.setProjectId(e.getProjectId()-1)}))})),o.renderProjectsTabs(e),d.initPageLoadTasks(),o.renderProjectDetails("all-tasks","All tasks"),t},createNewTaskFormSubmit:(e,t,s)=>{const{titleValue:i,dueDateValue:c,priorityValue:n,descValue:o}=a(e.target);p.getProject(s).createTask(i,c,n||3,o,s),e.preventDefault(),r.closePopup(t)},editTaskFormSubmit:(e,t,s,r)=>{const{titleValue:i,dueDateValue:c,priorityValue:o,descValue:l,stateValue:p}=a(e.target);t.setTitle(i),t.setDesc(l),t.setDueDate(c),t.setPriority(o),t.setState(p),isNaN(Number(r))?d.renderGeneralTabsTasks(r):n.renderTasks(s.getTasks()),e.preventDefault()},getProjects:()=>e,getProject:t=>e[t],getAllTasks:()=>e.reduce(((e,t)=>e.concat(t.getTasks())),[]),getProjectId:t=>e.indexOf(t)}})();p.createProject("One Project","One Proj Desc"),p.getProjects()[0].createTask("1 One Task TODAY THIS WEEK",1,1,"desc",0),p.getProjects()[0].createTask("1 Two Task",-1,1,"desc",0),p.getProjects()[0].createTask("1 Three Task TODAY THIS WEEK",1,2,"desc",0),p.createProject("Two Project","Two Proj Desc"),p.getProjects()[1].createTask("2 One Task THIS WEEK",2,1,"desc",1),p.createProject("Three Project","Three Proj Desc"),p.getProjects()[2].createTask("3 One Task TODAY THIS WEEK ",1,3,"desc",2),p.getProjects()[2].createTask("3 Two Task",-1,1,"desc",2),console.log(p.getProjects()),d.initPageLoadTasks()})();