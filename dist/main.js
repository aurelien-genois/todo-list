(()=>{"use strict";const e=(t=document,{createTextarea:(e,t,s,r)=>{const a=document.createElement("textarea");return a.setAttribute("id",e),a.setAttribute("name",t),a.setAttribute("maxlength",s),a.classList.add(...r),a},createTextInput:(e,s,r,a)=>{const n=t.createElement("input");return n.setAttribute("type","text"),n.setAttribute("id",e),n.setAttribute("name",s),n.setAttribute("maxlength",r),n.classList.add(...a),n.setAttribute("required",!0),n},createSubmit:(e,s)=>{const r=t.createElement("input");return r.setAttribute("type","submit"),r.setAttribute("value",e),r.classList.add(...s),r}});var t;const s=(t=>{const s=t.querySelector("#body");return{createFormInput:(s,r,a,n)=>{const c=t.createElement("label");switch(c.classList.add("popup-labels"),c.setAttribute("for",r),a){case"text":c.textContent=s;const a=e.createTextInput(r,r,25,["popup-inputs","popup-inputs-text"]);c.appendChild(a);break;case"date":c.textContent=s;const i=t.createElement("input");i.setAttribute("type","date"),i.setAttribute("name",r),i.setAttribute("id",r),i.classList.add("popup-inputs","popup-inputs-date"),i.setAttribute("required",!0),c.appendChild(i);break;case"textarea":c.classList.add("popup-labels-textarea");const o=t.createElement("span");o.textContent=s;const d=t.createElement("span");d.classList.add("parenthesis"),d.textContent=" (up to 100 characters)",o.appendChild(d);const p=e.createTextarea(r,r,100,["popup-inputs","popup-textareas"]);c.append(o,p);break;case"fieldset":c.textContent=s;const l=t.createElement("fieldset");l.setAttribute("id",r),l.classList.add("popup-inputs"),n.map((e=>{e.firstElementChild.setAttribute("name",r),l.appendChild(e)})),c.appendChild(l);break;case"radio":c.classList.remove("popup-labels");const u={Low:3,Medium:2,High:1},k=t.createElement("input");k.setAttribute("type","radio"),k.setAttribute("id",r),k.classList.add("popup-inputs-radio"),k.setAttribute("value",u[s]),c.appendChild(k),c.append(s)}return c},createForm:(s,r,a)=>{const n=t.createElement("form");n.setAttribute("id",s),n.classList.add("popup-forms"),a.map((e=>{n.appendChild(e)}));const c=e.createSubmit(r,["popup-submits"]);return n.appendChild(c),n},createPopupSection:(e,s,r,a)=>{const n=t.createElement("section");n.setAttribute("id",e),n.classList.add("popups");const c=t.createElement("div");c.classList.add("popup-containers"),n.appendChild(c);const i=t.createElement("h3");i.textContent=s,i.classList.add("popup-titles");const o=t.createElement("button");return o.textContent="X",o.setAttribute("id",r),o.classList.add("popup-close-btns"),c.append(i,o,a),n},openPopup:e=>{s.appendChild(e),e.style.opacity=0,setTimeout((()=>{e.style.opacity=1}),500)},closePopup:e=>{e.style.opacity=0,setTimeout((()=>{s.removeChild(e)}),500)}}})(document),r=(document,{newProjectPopup:()=>{let e=[];const t=s.createFormInput("Project title:","new-project-title","text"),r=s.createFormInput("Project description:","new-project-desc","textarea");e.push(t,r);const n=s.createForm("new-project-form","Create a new project",e),c=s.createPopupSection("new-project-popup","New project","new-project-close-btn",n);return n.addEventListener("submit",(e=>{a.createNewProjectFormSubmit(e,c)})),c.querySelector("#new-project-close-btn").addEventListener("click",s.closePopup.bind(void 0,c)),c},newTaskPopup:()=>{let e=[];const t=s.createFormInput("Task title:","new-task-title","text"),r=s.createFormInput("Due date:","new-task-duedate","date");let n=[];const c=s.createFormInput("Low","new-task-priority3","radio"),i=s.createFormInput("Medium","new-task-priority2","radio"),o=s.createFormInput("High","new-task-priority1","radio");n.push(c,i,o);const d=s.createFormInput("Priority:","new-task-priority","fieldset",n),p=s.createFormInput("Task description:","new-task-desc","textarea");e.push(t,r,d,p);const l=s.createForm("new-task-form","Create a new task",e);l.addEventListener("submit",(e=>{const t=new FormData(l);for(const e of t)switch(e[0]){case"new-task-title":var r=e[1];break;case"new-task-duedate":var n=e[1];break;case"new-task-priority":var c=e[1];break;case"new-task-desc":var i=e[1]}l.reset();const o=document.querySelector("#project-detail").dataset.projectId;a.getProject(o).createTask(r,n,c||3,i,o),e.preventDefault(),s.closePopup(u)}));const u=s.createPopupSection("new-task-popup","New task","new-task-close-btn",l);return u.querySelector("#new-task-close-btn").addEventListener("click",s.closePopup.bind(void 0,u)),u}}),a=(()=>{let e=[];const t=(t,s)=>{const r=o(t,s);return e.push(r),c.renderProjectsTabs(e),r},r=e=>{const t=new FormData(e);for(const e of t)switch(e[0]){case"new-project-title":var s=e[1];break;case"new-project-desc":var r=e[1];break;case"edit-project-title":s=e[1];break;case"edit-project-desc":r=e[1]}return e.reset(),{titleValue:s,descValue:r}};return{createProject:t,createNewProjectFormSubmit:(e,a)=>{const{titleValue:i,descValue:o}=r(e.target),d=t(i,o);c.renderProjectDetails(d),n.renderTasks(d.getTasks()),e.preventDefault(),s.closePopup(a)},editProjectFormSubmit:(e,t)=>{const{titleValue:s,descValue:a}=r(e.target);t.setTitle(s),t.setDesc(a),c.renderProjectDetails(t),e.preventDefault()},deleteProject:t=>{const s=e.indexOf(t);return e.splice(s,1),c.renderProjectsTabs(e),i.initPageLoadTasks(),c.renderProjectDetails("all-tasks","All tasks"),t},getProjects:()=>e,getProject:t=>e[t],getAllTasks:()=>e.reduce(((e,t)=>e.concat(t.getTasks())),[]),getProjectId:t=>e.indexOf(t)}})(),n=(e=>{const t=e.querySelector("#tasks-list"),s=e.querySelector("#project-detail");return{renderTasks:r=>{const n=r.map(((t,r)=>{const n=a.getProject(t.getProjectId()).getTaskId(t);return((t,r,n,c,i,o,d)=>{const p=e.createElement("li");p.classList.add("tasks"),p.setAttribute("data-task-id",d),p.setAttribute("data-project-id",o);const l=e.createElement("h3");l.textContent=t,l.classList.add("task-title");const u=e.createElement("div");u.classList.add("task-infos");const k=e.createElement("p");k.classList.add("task-duedate"),k.textContent=r;const b=e.createElement("p");b.classList.add("task-state"),b.textContent=c;const m=e.createElement("button");m.classList.add("task-expand-btn"),m.textContent="V",u.append(k,b,m),m.addEventListener("click",(()=>{p.querySelector(".task-expand")?(p.removeChild(T),m.textContent="V"):(p.append(T),m.textContent="A")}));const j=e.createElement("div");j.classList.add("task-main-infos"),j.append(l,u);const T=e.createElement("div");T.classList.add("task-expand");const P=e.createElement("div");P.classList.add("task-details");const g=e.createElement("p");g.classList.add("task-priority"),g.textContent=n;const h=e.createElement("p");h.classList.add("task-desc"),h.textContent=i,P.append(g,h);const y=e.createElement("div");y.classList.add("task-actions");const v=e.createElement("button");v.classList.add("edit-task-btn","round-btn"),v.textContent="/",v.addEventListener("click",(()=>{}));const E=e.createElement("button");return E.classList.add("round-btn","delete-task-btn"),E.textContent="X",E.addEventListener("click",(()=>{const e=s.dataset.projectId;a.getProject(o).deleteTask(d,e)})),y.append(v,E),T.append(P,y),p.append(j),p})(t.getTitle(),t.getDueDate(),t.getPriority(),t.getState(),t.getDesc(),t.getProjectId(),n)}));for(;t.firstChild;)t.removeChild(t.firstChild);n.map((e=>{t.appendChild(e)}))}}})(document),c=(t=>{const c=t.querySelector("#projects-tabs"),i=t.querySelector("#project-detail"),o=t.querySelector("#project-title"),d=t.querySelector("#project-desc"),p=document.querySelector("#new-project-btn"),l=t.querySelector("#new-task-btn"),u=t.querySelector("#edit-project-btn"),k=t.querySelector("#delete-project-btn");l.style.visibility="hidden",u.style.visibility="hidden";const b=t.querySelector("#project-infos");k.style.visibility="hidden",p.addEventListener("click",s.openPopup.bind(void 0,r.newProjectPopup())),l.addEventListener("click",s.openPopup.bind(void 0,r.newTaskPopup()));const m=(e,s)=>{if(t.querySelector("#edit-project-form")&&t.querySelector("#edit-project-form").replaceWith(b),"string"==typeof e)o.textContent=s,d.textContent="",i.setAttribute("data-project-id",e),l.style.visibility="hidden",u.style.visibility="hidden",k.style.visibility="hidden";else{o.textContent=e.getTitle(),d.textContent=e.getDesc();const t=a.getProjectId(e);i.setAttribute("data-project-id",t),l.style.visibility="visible",u.style.visibility="visible",k.style.visibility="visible"}};return u.addEventListener("click",(()=>{const s=a.getProject(i.dataset.projectId),r=s.getTitle(),n=s.getDesc(),c=t.createElement("form");c.setAttribute("id","edit-project-form");const o=t.createElement("fieldset");o.setAttribute("id","edit-project-inputs");const d=e.createTextInput("edit-project-title","edit-project-title",25,[]);d.value=r;const p=e.createTextarea("edit-project-desc","edit-project-desc",100,[]);p.value=n,o.append(d,p);const l=e.createSubmit("OK",["round-btn"]);c.addEventListener("submit",(e=>{a.editProjectFormSubmit(e,s)})),c.append(o,l),b.replaceWith(c)})),k.addEventListener("click",(()=>{const e=a.getProject(i.dataset.projectId);a.deleteProject(e)})),{renderProjectsTabs:e=>{const s=e.map((e=>{const s=t.createElement("li");return s.classList.add("tabs","project-tab"),s.textContent=e.getTitle(),s}));for(s.map(((t,s)=>t.addEventListener("click",(()=>{const t=e[s];n.renderTasks(t.getTasks()),m(t)}))));c.firstChild;)c.removeChild(c.firstChild);s.map((e=>{c.appendChild(e)}))},renderProjectDetails:m}})(document),i=(e=>{const t=e=>{let t=a.getAllTasks(),s=[];switch(e){case"today":s=t.filter((e=>1===e.getDueDate()));break;case"this-week":s=t.filter((e=>e.getDueDate()>0));break;case"high-priority":s=t.filter((e=>"High"===e.getPriority()));break;case"all-tasks":s=[...t]}n.renderTasks(s)};return[...e.querySelector("#general-tabs").children].map((e=>e.addEventListener("click",(e=>{const s=e.target.dataset.tab,r=e.target.textContent;t(s),c.renderProjectDetails(s,r)})))),{initPageLoadTasks:()=>{let e=a.getAllTasks();n.renderTasks(e)},renderGeneralTabsTasks:t}})(document),o=(e,t)=>{const s={getTitle:()=>e,setTitle:t=>e=t,getDesc:()=>t,setDesc:e=>t=e,getTasks(){return this.tasks},getTask(e){return this.tasks[e]},getTaskId(e){return this.tasks.indexOf(e)},createTask(e,t,s,r,a){this.tasks.push(d(e,t,s,r,a)),n.renderTasks(this.tasks)},deleteTask(e,t){this.tasks.splice(e,1),isNaN(Number(t))?i.renderGeneralTabsTasks(t):n.renderTasks(this.tasks)}};return Object.assign(Object.create(s),{tasks:[]})},d=(e,t,s,r,a)=>{const n={getTitle:()=>e,setTitle:t=>e=t,getDueDate:()=>t,setDueDate:e=>t=e,getDesc:()=>r,setDesc:e=>r=e,getProjectId:()=>a,setProjectId:e=>a=e,taskPriorities:["High","Medium","Low"],getPriority(){return this.taskPriorities[s-1]},setPriority(e){s=e},taskStates:["Done","WIP","Todo","Abandoned"],getState(){return this.taskStates[this.stateDegree-1]},setState(e){this.stateDegree=e}};return Object.assign(Object.create(n),{stateDegree:3})};a.createProject("One Project","One Proj Desc"),a.getProjects()[0].createTask("1 One Task TODAY THIS WEEK HIGH",1,1,"desc",0),a.getProjects()[0].createTask("1 Two Task HIGH",-1,1,"desc",0),a.getProjects()[0].createTask("1 Three Task TODAY THIS WEEK",1,2,"desc",0),a.createProject("Two Project","Two Proj Desc"),a.getProjects()[1].createTask("2 One Task THIS WEEK HIGH",2,1,"desc",1),a.createProject("Three Project","Three Proj Desc"),a.getProjects()[2].createTask("3 One Task TODAY THIS WEEK ",1,3,"desc",2),a.getProjects()[2].createTask("3 Two Task HIGH",-1,1,"desc",2),console.log(a.getProjects()),i.initPageLoadTasks()})();