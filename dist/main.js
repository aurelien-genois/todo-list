(()=>{"use strict";const e=(t=document,{createTextarea:(e,t,s,a)=>{const r=document.createElement("textarea");return r.setAttribute("id",e),r.setAttribute("name",t),r.setAttribute("maxlength",s),r.classList.add(...a),r},createTextInput:(e,s,a,r)=>{const c=t.createElement("input");return c.setAttribute("type","text"),c.setAttribute("id",e),c.setAttribute("name",s),c.setAttribute("maxlength",a),c.classList.add(...r),c.setAttribute("required",!0),c},createSubmit:(e,s)=>{const a=t.createElement("input");return a.setAttribute("type","submit"),a.setAttribute("value",e),a.classList.add(...s),a}});var t;const s=(t=>{const s=t.querySelector("#body");return{createFormInput:(s,a,r,c)=>{const n=t.createElement("label");switch(n.classList.add("popup-labels"),n.setAttribute("for",a),r){case"text":n.textContent=s;const r=e.createTextInput(a,a,25,["popup-inputs","popup-inputs-text"]);n.appendChild(r);break;case"date":n.textContent=s;const i=t.createElement("input");i.setAttribute("type","date"),i.setAttribute("name",a),i.setAttribute("id",a),i.classList.add("popup-inputs","popup-inputs-date"),i.setAttribute("required",!0),n.appendChild(i);break;case"textarea":n.classList.add("popup-labels-textarea");const o=t.createElement("span");o.textContent=s;const d=t.createElement("span");d.classList.add("parenthesis"),d.textContent=" (up to 100 characters)",o.appendChild(d);const l=e.createTextarea(a,a,100,["popup-inputs","popup-textareas"]);n.append(o,l);break;case"fieldset":n.textContent=s;const p=t.createElement("fieldset");p.setAttribute("id",a),p.classList.add("popup-inputs"),c.map((e=>{e.firstElementChild.setAttribute("name",a),p.appendChild(e)})),n.appendChild(p);break;case"radio":n.classList.remove("popup-labels");const u={Low:3,Medium:2,High:1},k=t.createElement("input");k.setAttribute("type","radio"),k.setAttribute("id",a),k.classList.add("popup-inputs-radio"),k.setAttribute("value",u[s]),n.appendChild(k),n.append(s)}return n},createForm:(s,a,r)=>{const c=t.createElement("form");c.setAttribute("id",s),c.classList.add("popup-forms"),r.map((e=>{c.appendChild(e)}));const n=e.createSubmit(a,["popup-submits"]);return c.appendChild(n),c},createPopupSection:(e,s,a,r)=>{const c=t.createElement("section");c.setAttribute("id",e),c.classList.add("popups");const n=t.createElement("div");n.classList.add("popup-containers"),c.appendChild(n);const i=t.createElement("h3");i.textContent=s,i.classList.add("popup-titles");const o=t.createElement("button");return o.textContent="X",o.setAttribute("id",a),o.classList.add("popup-close-btns"),n.append(i,o,r),c},openPopup:e=>{s.appendChild(e),e.style.opacity=0,setTimeout((()=>{e.style.opacity=1}),500)},closePopup:e=>{e.style.opacity=0,setTimeout((()=>{s.removeChild(e)}),500)}}})(document),a=(document,{newProjectPopup:()=>{let e=[];const t=s.createFormInput("Project title:","new-project-title","text"),a=s.createFormInput("Project description:","new-project-desc","textarea");e.push(t,a);const c=s.createForm("new-project-form","Create a new project",e),n=s.createPopupSection("new-project-popup","New project","new-project-close-btn",c);return c.addEventListener("submit",(e=>{r.createNewProjectFormSubmit(e,n)})),n.querySelector("#new-project-close-btn").addEventListener("click",s.closePopup.bind(void 0,n)),n},newTaskPopup:()=>{let e=[];const t=s.createFormInput("Task title:","new-task-title","text"),a=s.createFormInput("Due date:","new-task-duedate","date");let c=[];const n=s.createFormInput("Low","new-task-priority3","radio"),i=s.createFormInput("Medium","new-task-priority2","radio"),o=s.createFormInput("High","new-task-priority1","radio");c.push(n,i,o);const d=s.createFormInput("Priority:","new-task-priority","fieldset",c),l=s.createFormInput("Task description:","new-task-desc","textarea");e.push(t,a,d,l);const p=s.createForm("new-task-form","Create a new task",e);p.addEventListener("submit",(e=>{r.createNewTaskFormSubmit(e,u)}));const u=s.createPopupSection("new-task-popup","New task","new-task-close-btn",p);return u.querySelector("#new-task-close-btn").addEventListener("click",s.closePopup.bind(void 0,u)),u}}),r=(()=>{let e=[];const t=(t,s)=>{const a=o(t,s);return e.push(a),n.renderProjectsTabs(e),a},a=e=>{const t=new FormData(e);for(const e of t)switch(e[0]){case"new-project-title":var s=e[1];break;case"new-project-desc":var a=e[1];break;case"edit-project-title":s=e[1];break;case"edit-project-desc":a=e[1]}return e.reset(),{titleValue:s,descValue:a}};return{createProject:t,createNewProjectFormSubmit:(e,r)=>{const{titleValue:i,descValue:o}=a(e.target),d=t(i,o);n.renderProjectDetails(d),c.renderTasks(d.getTasks()),e.preventDefault(),s.closePopup(r)},editProjectFormSubmit:(e,t)=>{const{titleValue:s,descValue:r}=a(e.target);t.setTitle(s),t.setDesc(r),n.renderProjectDetails(t),e.preventDefault()},deleteProject:t=>{const s=e.indexOf(t);return e.splice(s,1),n.renderProjectsTabs(e),i.initPageLoadTasks(),n.renderProjectDetails("all-tasks","All tasks"),t},createNewTaskFormSubmit:(e,t)=>{const{titleValue:a,dueDateValue:c,priorityValue:n,descValue:i}=(e=>{const t=new FormData(e);for(const e of t)switch(e[0]){case"new-task-title":var s=e[1];break;case"new-task-duedate":var a=e[1];break;case"new-task-priority":var r=e[1];break;case"new-task-desc":var c=e[1];break;case"edit-task-title":s=e[1];break;case"edit-task-duedate":a=e[1];break;case"edit-task-priority":r=e[1];break;case"edit-task-desc":c=e[1];break;case"edit-task-state":var n=e[1]}return e.reset(),{titleValue:s,dueDateValue:a,priorityValue:r,descValue:c,stateValue:n}})(e.target),o=document.querySelector("#project-detail").dataset.projectId;r.getProject(o).createTask(a,c,n||3,i,o),e.preventDefault(),s.closePopup(t)},getProjects:()=>e,getProject:t=>e[t],getAllTasks:()=>e.reduce(((e,t)=>e.concat(t.getTasks())),[]),getProjectId:t=>e.indexOf(t)}})(),c=(e=>{const t=e.querySelector("#tasks-list"),s=e.querySelector("#project-detail");return{renderTasks:a=>{const c=a.map(((t,a)=>{const c=r.getProject(t.getProjectId()).getTaskId(t);return((t,a,c,n,i,o,d)=>{const l=e.createElement("li");l.classList.add("tasks"),l.setAttribute("data-task-id",d),l.setAttribute("data-project-id",o);const p=e.createElement("h3");p.textContent=t,p.classList.add("task-title");const u=e.createElement("div");u.classList.add("task-infos");const k=e.createElement("p");k.classList.add("task-duedate"),k.textContent=a;const b=e.createElement("p");b.classList.add("task-state"),b.textContent=n;const m=e.createElement("button");m.classList.add("task-expand-btn"),m.textContent="V",u.append(k,b,m),m.addEventListener("click",(()=>{l.querySelector(".task-expand")?(l.removeChild(T),m.textContent="V"):(l.append(T),m.textContent="A")}));const j=e.createElement("div");j.classList.add("task-main-infos"),j.append(p,u);const T=e.createElement("div");T.classList.add("task-expand");const P=e.createElement("div");P.classList.add("task-details");const g=e.createElement("p");g.classList.add("task-priority"),g.textContent=c;const h=e.createElement("p");h.classList.add("task-desc"),h.textContent=i,P.append(g,h);const y=e.createElement("div");y.classList.add("task-actions");const v=e.createElement("button");v.classList.add("edit-task-btn","round-btn"),v.textContent="/",v.addEventListener("click",(()=>{}));const E=e.createElement("button");return E.classList.add("round-btn","delete-task-btn"),E.textContent="X",E.addEventListener("click",(()=>{const e=s.dataset.projectId;r.getProject(o).deleteTask(d,e)})),y.append(v,E),T.append(P,y),l.append(j),l})(t.getTitle(),t.getDueDate(),t.getPriority(),t.getState(),t.getDesc(),t.getProjectId(),c)}));for(;t.firstChild;)t.removeChild(t.firstChild);c.map((e=>{t.appendChild(e)}))}}})(document),n=(t=>{const n=t.querySelector("#projects-tabs"),i=t.querySelector("#project-detail"),o=t.querySelector("#project-title"),d=t.querySelector("#project-desc"),l=document.querySelector("#new-project-btn"),p=t.querySelector("#new-task-btn"),u=t.querySelector("#edit-project-btn"),k=t.querySelector("#delete-project-btn");p.style.visibility="hidden",u.style.visibility="hidden";const b=t.querySelector("#project-infos");k.style.visibility="hidden",l.addEventListener("click",s.openPopup.bind(void 0,a.newProjectPopup())),p.addEventListener("click",s.openPopup.bind(void 0,a.newTaskPopup()));const m=(e,s)=>{if(t.querySelector("#edit-project-form")&&t.querySelector("#edit-project-form").replaceWith(b),"string"==typeof e)o.textContent=s,d.textContent="",i.setAttribute("data-project-id",e),p.style.visibility="hidden",u.style.visibility="hidden",k.style.visibility="hidden";else{o.textContent=e.getTitle(),d.textContent=e.getDesc();const t=r.getProjectId(e);i.setAttribute("data-project-id",t),p.style.visibility="visible",u.style.visibility="visible",k.style.visibility="visible"}};return u.addEventListener("click",(()=>{const s=r.getProject(i.dataset.projectId),a=s.getTitle(),c=s.getDesc(),n=t.createElement("form");n.setAttribute("id","edit-project-form");const o=t.createElement("fieldset");o.setAttribute("id","edit-project-inputs");const d=e.createTextInput("edit-project-title","edit-project-title",25,[]);d.value=a;const l=e.createTextarea("edit-project-desc","edit-project-desc",100,[]);l.value=c,o.append(d,l);const p=e.createSubmit("OK",["round-btn"]);n.addEventListener("submit",(e=>{r.editProjectFormSubmit(e,s)})),n.append(o,p),b.replaceWith(n)})),k.addEventListener("click",(()=>{const e=r.getProject(i.dataset.projectId);r.deleteProject(e)})),{renderProjectsTabs:e=>{const s=e.map((e=>{const s=t.createElement("li");return s.classList.add("tabs","project-tab"),s.textContent=e.getTitle(),s}));for(s.map(((t,s)=>t.addEventListener("click",(()=>{const t=e[s];c.renderTasks(t.getTasks()),m(t)}))));n.firstChild;)n.removeChild(n.firstChild);s.map((e=>{n.appendChild(e)}))},renderProjectDetails:m}})(document),i=(e=>{const t=e=>{let t=r.getAllTasks(),s=[];switch(e){case"today":s=t.filter((e=>1===e.getDueDate()));break;case"this-week":s=t.filter((e=>e.getDueDate()>0));break;case"high-priority":s=t.filter((e=>"High"===e.getPriority()));break;case"all-tasks":s=[...t]}c.renderTasks(s)};return[...e.querySelector("#general-tabs").children].map((e=>e.addEventListener("click",(e=>{const s=e.target.dataset.tab,a=e.target.textContent;t(s),n.renderProjectDetails(s,a)})))),{initPageLoadTasks:()=>{let e=r.getAllTasks();c.renderTasks(e)},renderGeneralTabsTasks:t}})(document),o=(e,t)=>{const s={getTitle:()=>e,setTitle:t=>e=t,getDesc:()=>t,setDesc:e=>t=e,getTasks(){return this.tasks},getTask(e){return this.tasks[e]},getTaskId(e){return this.tasks.indexOf(e)},createTask(e,t,s,a,r){this.tasks.push(d(e,t,s,a,r)),c.renderTasks(this.tasks)},deleteTask(e,t){this.tasks.splice(e,1),isNaN(Number(t))?i.renderGeneralTabsTasks(t):c.renderTasks(this.tasks)}};return Object.assign(Object.create(s),{tasks:[]})},d=(e,t,s,a,r)=>{const c={getTitle:()=>e,setTitle:t=>e=t,getDueDate:()=>t,setDueDate:e=>t=e,getDesc:()=>a,setDesc:e=>a=e,getProjectId:()=>r,setProjectId:e=>r=e,taskPriorities:["High","Medium","Low"],getPriority(){return this.taskPriorities[s-1]},setPriority(e){s=e},taskStates:["Done","WIP","Todo","Abandoned"],getState(){return this.taskStates[this.stateDegree-1]},setState(e){this.stateDegree=e}};return Object.assign(Object.create(c),{stateDegree:3})};r.createProject("One Project","One Proj Desc"),r.getProjects()[0].createTask("1 One Task TODAY THIS WEEK HIGH",1,1,"desc",0),r.getProjects()[0].createTask("1 Two Task HIGH",-1,1,"desc",0),r.getProjects()[0].createTask("1 Three Task TODAY THIS WEEK",1,2,"desc",0),r.createProject("Two Project","Two Proj Desc"),r.getProjects()[1].createTask("2 One Task THIS WEEK HIGH",2,1,"desc",1),r.createProject("Three Project","Three Proj Desc"),r.getProjects()[2].createTask("3 One Task TODAY THIS WEEK ",1,3,"desc",2),r.getProjects()[2].createTask("3 Two Task HIGH",-1,1,"desc",2),console.log(r.getProjects()),i.initPageLoadTasks()})();